{% extends 'base.html.twig' %}
{% block title %}
Gestion du panier
{% endblock %}


{% block body %}
    <h1>Gestion du panier</h1>
    <table class="table">
        <tr>
            <th>article</th>
            <th>id_article</th>
            <th>quantite</th>
            <th>prix_unitaire</th>
            <th>prix_total</th>
            <th></th>
        </tr>
        <tr>
            <th>PRODUITS</th>
        </tr>
        {% set i=0 %}
        {% for productContent in sale.products %}
            {% set i=1-i %}
            <tr {% if i%2==0 %}class="bg-info"{%  else %}class="bg-secondary"{% endif %}>
                <td >{{ productContent.product.name }}</td>
                <td > {{ productContent.product.id }}</td>
                <td ><input onblur="updateProductQuantity('product',{{ productContent.product.id }})" id="productinput" value="{{ productContent.quantity }}"
                           type="text"></td>
                <td >{{ productContent.pricewhenbought/100.0 }}</td>
                <td >{{ productContent.pricewhenbought * productContent.quantity/100.0 }}</td>
                <td >
                    <a href="/panier/rmProduct/{{ productContent.product.id }}"><button  class="btn btn-success ">-</button></a>
                    <a href="/panier/addProduct/{{ productContent.product.id }}"><button class="btn  btn-success">+</button></a>
                    <a href="/panier/delProduct/{{ productContent.product.id }}"><button class="btn  btn-danger">X</button></a>

                </td>
            </tr>
        {% endfor %}

        <tr>
            <th>SERVICES</th>
        </tr>
        {% for serviceContent in sale.services %}
            {% set i=1-i %}
            <tr {% if i%2==0 %}class="bg-info"{%  else %}class="bg-secondary"{% endif %}>
                <td >{{ serviceContent.service.name }}</td>
                <td > {{ serviceContent.service.id }}</td>
                <td ><input onblur="updateProductQuantity('service',{{ serviceContent.service.id }})" id="serviceinput" value="{{ serviceContent.quantity }}"
                           type="text"></td>
                <td >{{ serviceContent.pricewhenbought/100.0 }}</td>
                <td >{{ serviceContent.pricewhenbought * serviceContent.quantity/100.0 }}</td>
                <td >
                    <a href="/panier/rmService/{{ serviceContent.service.id }}"><button class="btn btn-success">-</button></a>
                    <a href="/panier/addService/{{ serviceContent.service.id }}"><button class="btn btn-success">+</button></a>
                    <a href="/panier/delService/{{ serviceContent.service.id }}"><button class="btn  btn-danger">X</button></a>
                </td>
            </tr>
        {% endfor %}
        <tr>
            <th>OFFERS</th>
        </tr>
        {% for offerContent in sale.offers %}
            {% set i=1-i %}
            <tr {% if i%2==0 %}class="bg-info"{%  else %}class="bg-secondary"{% endif %}>
                <td >{{ offerContent.offer.name }}</td>
                <td > {{ offerContent.offer.id }}</td>
                <td ><input onblur="updateProductQuantity('offer',{{ offerContent.offer.id }})" id="offerinput" value="{{ offerContent.quantity }}">
                </td>
                <td >{{ offerContent.pricewhenbought/100.0 }}</td>
                <td >{{ offerContent.pricewhenbought * offerContent.quantity/100.0 }}</td>
                <td >
                    <a href="/panier/rmOffer/{{ offerContent.offer.id }}"><button class="btn btn-success">-</button></a>
                    <a href="/panier/addOffer/{{ offerContent.offer.id }}"><button class="btn btn-success">+</button></a>
                    <a href="/panier/delOffer/{{ offerContent.offer.id }}"><button class="btn  btn-danger">X</button></a>
                </td>
            </tr>
        {% endfor %}
        <tr>
            <th>TOTAL</th>
            <th></th>
            <th></th>
            <th></th>
            <th>{% if sale!=null %}{{ sale.price()/100.0 }}{% endif %}</th>
            <th>
                <a href="/user/panier/save"><button class="btn btn-success">COMMANDER</button></a>
                <br>
                <a href="/panier/clear"><button class="btn  btn-danger">VIDER LE PANIER</button></a>
            </th>
        </tr>
    </table>

{% endblock %}

{% block javascripts %}
    {{ parent() }}
    <script type="application/javascript" src="{{ asset("web/js/panier.js") }}">

    </script>
{% endblock %}